{"remainingRequest":"F:\\Project\\vue-router-auto\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Project\\vue-router-auto\\src\\views\\pages\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Project\\vue-router-auto\\src\\views\\pages\\index.vue","mtime":1632819454779},{"path":"F:\\Project\\vue-router-auto\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1631353801030},{"path":"F:\\Project\\vue-router-auto\\node_modules\\babel-loader\\lib\\index.js","mtime":1631353804156},{"path":"F:\\Project\\vue-router-auto\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1631353801030},{"path":"F:\\Project\\vue-router-auto\\node_modules\\vue-loader\\lib\\index.js","mtime":1631353805156}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIEAgaXMgYW4gYWxpYXMgdG8gL3NyYwppbXBvcnQgc3BlYWtlYXN5IGZyb20gJ3NwZWFrZWFzeScKaW1wb3J0IFFSQ29kZSBmcm9tICdxcmNvZGUnCmltcG9ydCBjb29raWVzIGZyb20gJ3Z1ZS1jb29raWVzJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2hvbWUnLAogIGNvbXBvbmVudHM6IHsKICAgIAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzMmZhOiBmYWxzZSwKICAgICAgc2VjcmV0Q29kZTogJycsCiAgICAgIHFyQ29kZTogJycsCiAgICAgIHJ1bGVzOiBbCiAgICAgICAgdmFsdWUgPT4gISF2YWx1ZSB8fCAnUmVxdWlyZWQuJywgICAgICAgIAogICAgICAgIHZhbHVlID0+IHsKICAgICAgICAgIGNvbnN0IHBhdHRlcm4gPSAvXlxkKyQvCiAgICAgICAgICByZXR1cm4gcGF0dGVybi50ZXN0KHZhbHVlKSB8fCAnSW52YWxpZCBPVFAuJwogICAgICAgIH0sCiAgICAgICAgdmFsdWUgPT4gKHZhbHVlIHx8ICcnKS5sZW5ndGggPT09IDYgfHwgJ011c3QgNiBkaWdpdHMnLAogICAgICBdLAogICAgICBvdHA6ICcnCiAgICB9CiAgfSwKICBjcmVhdGVkICgpIHsKICAgIGNvb2tpZXMuc2V0KCd0aGVtZScsJ2RlZmF1bHQnKQogICAgYWxlcnQoY29va2llcy5nZXQoJ3Z1ZXgnKSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZW5lcmF0ZV8yZmEoKSB7CiAgICAgIHRoaXMuc2VjcmV0Q29kZSA9IHNwZWFrZWFzeS5nZW5lcmF0ZVNlY3JldCh7CiAgICAgICAgbGVuZ3RoOiA1MTIsCiAgICAgICAgbmFtZTogJ1Rlc3QgR29vZ2xlIEF1dGhlbnRpY2F0b3IgKHRlc3RAZW1haWwuY29tKScKICAgICAgfSk7CgogICAgICBsZXQgb3RwYXV0aF91cmwgPSBzcGVha2Vhc3kub3RwYXV0aFVSTCh7CiAgICAgICAgc2VjcmV0OiB0aGlzLnNlY3JldENvZGUuYmFzZTMyLAogICAgICAgIGxhYmVsOiAndGVzdEBlbWFpbC5jb20nLAogICAgICAgIHR5cGU6ICd0b3RwJywKICAgICAgICBpc3N1ZXI6ICdUZXN0IEdvb2dsZSBBdXRoZW50aWNhdG9yJywKICAgICAgICBhbGdvcml0aG06ICdzaGE1MTInLAogICAgICAgIGVuY29kaW5nOiAnYmFzZTY0JwogICAgICB9KQoKICAgICAgLy8gR2V0IHRoZSBkYXRhIFVSTCBvZiB0aGUgYXV0aGVudGljYXRvciBVUkwKICAgICAgUVJDb2RlLnRvRGF0YVVSTChvdHBhdXRoX3VybCwgKGVyciwgZGF0YV91cmwpID0+IHsKICAgICAgICB0aGlzLnFyQ29kZSA9IGRhdGFfdXJsCiAgICAgIH0pOwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnc2F2ZScsIHsgc2VjcmV0Q29kZTogdGhpcy5zZWNyZXRDb2RlLmJhc2UzMiwgb3RwYXV0aHVybCA6IG90cGF1dGhfdXJsfSkKICAgIH0sCiAgICB2ZXJpZnkoKXsKICAgICAgbGV0IHJlc3VsdCA9IHNwZWFrZWFzeS50b3RwLnZlcmlmeSh7CiAgICAgICAgc2VjcmV0OiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyJnZXRBbGwiXS5zZWNyZXRDb2RlLAogICAgICAgIHRva2VuOiB0aGlzLm90cCwKICAgICAgICBhbGdvcml0aG06ICdzaGE1MTInLAogICAgICAgIGVuY29kaW5nOiAnYmFzZTY0JwogICAgICB9KQogICAgICBhbGVydChyZXN1bHQpCiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/pages","sourcesContent":["<template>\n  <v-container>\n      <v-row class=\"text-center\">\n        <v-col cols=\"12\">\n          <v-btn block x-large color=\"primary\" @click=\"generate_2fa\">Generate 2FA</v-btn>\n          <div v-if=\"secretCode\">\n            <img v-if=\"true\" :src=\"qrCode\" class=\"img-fluid\" alt=\"\">\n            <v-card class=\"justify-center d-flex mx-auto mt-5\">\n              <v-card-text>\n                <div class=\"font-weight-bold ml-8 h3 mb-2 text-dark\">\n                  Secret Code\n                </div>\n\n                <v-timeline align-top dense>\n                  <v-timeline-item color=\"red\" small>\n                    <div class=\"text-justify text-dark\">\n                      <div class=\"font-weight-normal\">\n                        <strong>ASCII</strong>\n                      </div>\n                      <div>{{secretCode.ascii}}</div>\n                    </div>\n                  </v-timeline-item>\n                </v-timeline>\n                <v-timeline align-top dense>\n                  <v-timeline-item color=\"red\" small>\n                    <div class=\"text-justify text-dark\">\n                      <div class=\"font-weight-normal\">\n                        <strong>HEX</strong>\n                      </div>\n                      <div>{{secretCode.hex}}</div>\n                    </div>\n                  </v-timeline-item>\n                </v-timeline>\n                <v-timeline align-top dense>\n                  <v-timeline-item color=\"red\" small>\n                    <div class=\"text-justify text-dark\">\n                      <div class=\"font-weight-normal\">\n                        <strong>Base 32</strong>\n                      </div>\n                      <div>{{secretCode.base32}}</div>\n                    </div>\n                  </v-timeline-item>\n                </v-timeline>\n                <v-timeline align-top dense>\n                  <v-timeline-item color=\"red\" small>\n                    <div class=\"text-justify text-dark\">\n                      <div class=\"font-weight-normal\">\n                        <strong>OTP Auth URL</strong>\n                      </div>\n                      <div>{{secretCode.otpauth_url}}</div>\n                    </div>\n                  </v-timeline-item>\n                </v-timeline>\n\n              </v-card-text>\n            </v-card>\n            \n          </div>\n          <v-text-field label=\"Verify OTP\" :rules=\"rules\" hide-details=\"auto\" class=\"my-3\" v-model=\"otp\"></v-text-field>\n          <v-btn class=\"w-50\" x-large color=\"primary\" @click=\"verify\">Verify</v-btn>\n        </v-col>\n      </v-row>\n  </v-container>\n</template>\n\n<script>\n// @ is an alias to /src\nimport speakeasy from 'speakeasy'\nimport QRCode from 'qrcode'\nimport cookies from 'vue-cookies'\nexport default {\n  name: 'home',\n  components: {\n    \n  },\n  data() {\n    return {\n      is2fa: false,\n      secretCode: '',\n      qrCode: '',\n      rules: [\n        value => !!value || 'Required.',        \n        value => {\n          const pattern = /^\\d+$/\n          return pattern.test(value) || 'Invalid OTP.'\n        },\n        value => (value || '').length === 6 || 'Must 6 digits',\n      ],\n      otp: ''\n    }\n  },\n  created () {\n    cookies.set('theme','default')\n    alert(cookies.get('vuex'));\n  },\n  methods: {\n    generate_2fa() {\n      this.secretCode = speakeasy.generateSecret({\n        length: 512,\n        name: 'Test Google Authenticator (test@email.com)'\n      });\n\n      let otpauth_url = speakeasy.otpauthURL({\n        secret: this.secretCode.base32,\n        label: 'test@email.com',\n        type: 'totp',\n        issuer: 'Test Google Authenticator',\n        algorithm: 'sha512',\n        encoding: 'base64'\n      })\n\n      // Get the data URL of the authenticator URL\n      QRCode.toDataURL(otpauth_url, (err, data_url) => {\n        this.qrCode = data_url\n      });\n      this.$store.dispatch('save', { secretCode: this.secretCode.base32, otpauthurl : otpauth_url})\n    },\n    verify(){\n      let result = speakeasy.totp.verify({\n        secret: this.$store.getters[\"getAll\"].secretCode,\n        token: this.otp,\n        algorithm: 'sha512',\n        encoding: 'base64'\n      })\n      alert(result)\n    }\n  },\n}\n</script>\n<style scoped>\n\n</style>"]}]}